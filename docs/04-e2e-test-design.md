# E2Eテスト設計（v0）

## 方針
- Unitテストは導入しない。
- E2Eテストのみで主要ユーザーフローを担保する。
- テストはローカル環境で実行可能とする。
- 失敗時に原因が追いやすい粒度のシナリオに分割する。

## ツール選定（案）
- Playwright を第一候補。
  - 理由: Next.jsとの相性、並列実行、トレース機能が有用。
  - 代替案: Cypress（必要であれば切り替え可能）。

## 対象範囲（MVP）
- タスクの作成
- タスク一覧表示
- 完了/未完了切り替え
- 編集（インライン編集）
- 削除
- フィルタ切り替え
- ソート切り替え
- LocalStorage 永続化
- 空状態の表示
- レスポンシブの最低限確認（PC/モバイルの1シナリオずつ）

## 対象外
- 認証関連
- 外部サービス連携
- パフォーマンス測定（v0では任意）

## 実行環境
- Node.js（ローカル）
- Next.js dev server or production build
- ブラウザ: Chromium を基本、必要に応じて WebKit / Firefox を追加

## テストデータ管理
- 各テストは LocalStorage をクリアして開始する。
- テストデータはUI操作で投入する（E2E観点を優先）。
- データ件数は 1〜3件に限定し、判定しやすくする。

## テスト観点とシナリオ

### 1. 空状態
- 事前条件: LocalStorageが空
- 期待結果: 空状態メッセージが表示される

### 2. タスク作成
- 事前条件: 空状態
- 手順: タイトルのみで作成
- 期待結果: 一覧に追加され、合計/未完了カウントが更新される

### 3. タスク作成（任意項目含む）
- 手順: タイトル + 説明 + 期限 + 優先度
- 期待結果: すべて表示される

### 4. 完了/未完了切り替え
- 手順: 完了ボタンを押下
- 期待結果: 表示スタイルが変わり、未完了/完了カウントが更新される

### 5. 編集（インライン）
- 手順: 編集ボタン → タイトル/説明/期限/優先度を変更 → 保存
- 期待結果: 内容が更新される

### 6. バリデーション
- 手順: タイトル空で保存
- 期待結果: エラーメッセージ表示、保存されない

### 7. 削除
- 手順: 削除ボタン押下
- 期待結果: 一覧から消え、カウント更新

### 8. フィルタ
- 手順: 完了/未完了で切り替え
- 期待結果: 表示対象が切り替わる

### 9. ソート
- 手順: 期限/優先度に切り替え
- 期待結果: 並び順がルール通りになる

### 10. 永続化
- 手順: タスク作成 → ページリロード
- 期待結果: タスクが保持される

### 11. レスポンシブ
- 手順: 画面幅をSPサイズに変更
- 期待結果: レイアウトが崩れない

## テスト容易性のためのUI仕様（提案）
- `data-testid` を主要要素に付与
  - 例: `task-form`, `task-title-input`, `task-add-button`, `task-card`, `filter-all`, `filter-active`, `sort-select`
- タスクカードには `data-task-id` を付与

## 例: テストケースの命名規約
- `task-create-basic`
- `task-toggle-complete`
- `task-inline-edit`
- `task-filter-completed`
- `task-sort-priority`

## 今後の追加候補
- 期限切れタスクの強調表示テスト
- 大量件数のスクロール確認
- ダークモード対応時のテスト（導入時）
